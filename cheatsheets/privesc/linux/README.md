<div class="entry-content">
						<!-- AddThis Sharing Buttons above -->
                <div class="addthis_toolbox addthis_default_style addthis_32x32_style" addthis:url="https://www.rebootuser.com/?p=1623" addthis:title="Local Linux Enumeration &amp; Privilege Escalation Cheatsheet">
                    <a class="addthis_button_facebook addthis_button_preferred_1 at300b" title="Facebook" href="#"><span class="at-icon-wrapper" style="background-color: rgb(59, 89, 152); line-height: 32px; height: 32px; width: 32px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" title="Facebook" alt="Facebook" class="at-icon at-icon-facebook" style="width: 32px; height: 32px;"><g><path d="M22 5.16c-.406-.054-1.806-.16-3.43-.16-3.4 0-5.733 1.825-5.733 5.17v2.882H9v3.913h3.837V27h4.604V16.965h3.823l.587-3.913h-4.41v-2.5c0-1.123.347-1.903 2.198-1.903H22V5.16z" fill-rule="evenodd"></path></g></svg></span></a>
                    <a class="addthis_button_tumblr addthis_button_preferred_2 at300b" target="_blank" title="Tumblr" href="#"><span class="at-icon-wrapper" style="background-color: rgb(55, 69, 92); line-height: 32px; height: 32px; width: 32px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" title="Tumblr" alt="Tumblr" class="at-icon at-icon-tumblr" style="width: 32px; height: 32px;"><g><path d="M19.59 22.176c-.392.186-1.14.348-1.695.362-1.682.045-2.008-1.18-2.022-2.07V13.93h4.218v-3.18H15.89V5.403h-3.076c-.05 0-.138.044-.15.157-.18 1.636-.947 4.51-4.133 5.66v2.71h2.124v6.862c0 2.35 1.733 5.688 6.308 5.61 1.544-.028 3.258-.674 3.637-1.23l-1.01-2.996" fill-rule="evenodd"></path></g></svg></span></a>
                    <a class="addthis_button_twitter addthis_button_preferred_3 at300b" title="Tweet" href="#"><span class="at-icon-wrapper" style="background-color: rgb(29, 161, 242); line-height: 32px; height: 32px; width: 32px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" title="Twitter" alt="Twitter" class="at-icon at-icon-twitter" style="width: 32px; height: 32px;"><g><path d="M27.996 10.116c-.81.36-1.68.602-2.592.71a4.526 4.526 0 0 0 1.984-2.496 9.037 9.037 0 0 1-2.866 1.095 4.513 4.513 0 0 0-7.69 4.116 12.81 12.81 0 0 1-9.3-4.715 4.49 4.49 0 0 0-.612 2.27 4.51 4.51 0 0 0 2.008 3.755 4.495 4.495 0 0 1-2.044-.564v.057a4.515 4.515 0 0 0 3.62 4.425 4.52 4.52 0 0 1-2.04.077 4.517 4.517 0 0 0 4.217 3.134 9.055 9.055 0 0 1-5.604 1.93A9.18 9.18 0 0 1 6 23.85a12.773 12.773 0 0 0 6.918 2.027c8.3 0 12.84-6.876 12.84-12.84 0-.195-.005-.39-.014-.583a9.172 9.172 0 0 0 2.252-2.336" fill-rule="evenodd"></path></g></svg></span></a>
                    <a class="addthis_button_print addthis_button_preferred_4 at300b" title="Print" href="#"><span class="at-icon-wrapper" style="background-color: rgb(115, 138, 141); line-height: 32px; height: 32px; width: 32px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" title="Print" alt="Print" class="at-icon at-icon-print" style="width: 32px; height: 32px;"><g><path d="M24.67 10.62h-2.86V7.49H10.82v3.12H7.95c-.5 0-.9.4-.9.9v7.66h3.77v1.31L15 24.66h6.81v-5.44h3.77v-7.7c-.01-.5-.41-.9-.91-.9zM11.88 8.56h8.86v2.06h-8.86V8.56zm10.98 9.18h-1.05v-2.1h-1.06v7.96H16.4c-1.58 0-.82-3.74-.82-3.74s-3.65.89-3.69-.78v-3.43h-1.06v2.06H9.77v-3.58h13.09v3.61zm.75-4.91c-.4 0-.72-.32-.72-.72s.32-.72.72-.72c.4 0 .72.32.72.72s-.32.72-.72.72zm-4.12 2.96h-6.1v1.06h6.1v-1.06zm-6.11 3.15h6.1v-1.06h-6.1v1.06z"></path></g></svg></span></a>
                    <a class="addthis_button_compact at300m" href="#"><span class="at-icon-wrapper" style="background-color: rgb(255, 101, 80); line-height: 32px; height: 32px; width: 32px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" title="More" alt="More" class="at-icon at-icon-addthis" style="width: 32px; height: 32px;"><g><path d="M18 14V8h-4v6H8v4h6v6h4v-6h6v-4h-6z" fill-rule="evenodd"></path></g></svg></span></a>
                    <a class="addthis_counter addthis_bubble_style" href="#" style="display: inline-block;"><a class="addthis_button_expanded" target="_blank" title="View more services" href="#">1.2K</a><a class="atc_s addthis_button_compact">Share<span></span></a></a>
                <div class="atclear"></div></div><p><span style="font-family: Arial, sans-serif;">The following post lists a few Linux commands that may come in useful when trying to escalate privileges on a target system. This is generally aimed at enumeration rather than specific vulnerabilities/exploits and I realise these are just the <strong>tip of the iceberg&nbsp;</strong>in terms of what’s available.<br>
</span></p>
<p>&nbsp;</p>
<p style="text-align: right;">&nbsp;<strong>Revision 1.1 (July 2014 update)</strong></p>
<p><span style="font-family: Arial, sans-serif;"><b>Kernel, Operating System &amp; Device Information:</b></span></p>
<table border="1" width="100%" cellspacing="0" cellpadding="10">
<colgroup>
<col width="117">
<col width="139"> </colgroup>
<tbody>
<tr valign="TOP">
<td width="46%"><span style="font-family: Arial, sans-serif;"><b>Command</b></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;"><b>Result</b></span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>uname -a</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Print all available system information</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>uname -r</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Kernel release</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>uname -n</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">System hostname</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>hostname</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">As above</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>uname -m</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Linux kernel architecture (32 or 64 bit)</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>cat /proc/version</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Kernel information</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>cat /etc/*-release</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Distribution information</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>cat /etc/issue</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">As above</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>cat /proc/cpuinfo</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">CPU information</span></td>
</tr>
<tr valign="TOP">
<td width="46%"><span style="font-family: Arial, sans-serif;"><code>df -a</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">File system information</span></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><span style="font-family: Arial, sans-serif;"><b>Users &amp; Groups:</b></span></p>
<table border="1" width="100%" cellspacing="0" cellpadding="10">
<colgroup>
<col width="117">
<col width="139"> </colgroup>
<tbody>
<tr valign="TOP">
<td width="46%"><span style="font-family: Arial, sans-serif;"><b>Command</b></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;"><b>Result</b></span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>cat /etc/passwd</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">List all users on the system</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>cat /etc/group</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">List all groups on the system</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>for i in $(cat /etc/passwd 2&gt;/dev/null| cut -d":" -f1 2&gt;/dev/null);do id $i;done 2&gt;/dev/null</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">List all uid’s and respective group memberships</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>cat /etc/shadow</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Show user hashes – <span style="color: #ff0000;">Privileged command</span></span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>grep -v -E "^#" /etc/passwd | awk -F: '$3 == 0 { print $1}'</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">List all super user accounts</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>finger</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Users currently logged in</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>pinky</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">As above</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>users</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">As above</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>who -a</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">As above</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>w</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Who is currently logged in and what they’re doing</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>last</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Listing of last logged on users</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>lastlog</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Information on when all users last logged in</span></td>
</tr>
<tr valign="TOP">
<td width="46%"><span style="font-family: Arial, sans-serif;"><code>lastlog –u %username%</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Information on when the specified user last logged in</span></td>
</tr>
<tr valign="TOP">
<td width="46%"><span style="font-family: Arial, sans-serif;"><code>lastlog |grep -v "Never"</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Entire list of previously logged on users</span></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><span id="more-1623"></span></p>
<p><span style="font-family: Arial, sans-serif;"><b>User &amp; Privilege Information:</b></span></p>
<table border="1" width="100%" cellspacing="0" cellpadding="10">
<colgroup>
<col width="117">
<col width="139"> </colgroup>
<tbody>
<tr valign="TOP">
<td width="46%"><span style="font-family: Arial, sans-serif;"><b>Command</b></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;"><b>Result</b></span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>whoami</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Current username</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>id</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Current user information</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>cat /etc/sudoers</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Who’s allowed to do what as root – <span style="color: #ff0000;">Privileged command</span></span></td>
</tr>
<tr valign="TOP">
<td width="46%"><span style="font-family: Arial, sans-serif;"><code>sudo -l</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Can the current user perform anything as root</span></td>
</tr>
<tr valign="TOP">
<td width="46%"><span style="font-family: Arial, sans-serif;"><code>sudo -l 2&gt;/dev/null | grep -w 'nmap|perl|'awk'|'find'|'bash'|'sh'|'man'<br>|'more'|'less'|'vi'|'vim'|'nc'|'netcat'|python<br>|ruby|lua|irb' | xargs -r ls -la 2&gt;/dev/null</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Can the current user run any ‘interesting’ binaries as root and if so also display the binary permissions etc.</span></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><span style="font-family: Arial, sans-serif;"><b>Environmental Information:</b></span></p>
<table border="1" width="100%" cellspacing="0" cellpadding="10">
<colgroup>
<col width="117">
<col width="139"> </colgroup>
<tbody>
<tr valign="TOP">
<td width="46%"><span style="font-family: Arial, sans-serif;"><b>Command</b></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;"><b>Result</b></span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>env</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Display environmental variables</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>set</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">As above</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>echo $PATH</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Path information</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>history</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Displays command history of current user</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>pwd</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Print working directory, i.e. ‘where am I’</span></td>
</tr>
<tr valign="TOP">
<td width="46%"><span style="font-family: Arial, sans-serif;"><code>cat /etc/profile</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Display default system variables</span></td>
</tr>
<tr valign="TOP">
<td width="46%"><span style="font-family: Arial, sans-serif;"><code>cat /etc/shells</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Display available shells</span></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><span style="font-family: Arial, sans-serif;"><b>Interesting Files:</b></span></p>
<table border="1" width="100%" cellspacing="0" cellpadding="10">
<colgroup>
<col width="117">
<col width="139"> </colgroup>
<tbody>
<tr valign="TOP">
<td width="46%"><span style="font-family: Arial, sans-serif;"><b>Command</b></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;"><b>Result</b></span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>find / -perm -4000 -type f 2&gt;/dev/null</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Find SUID files</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>find / -uid 0 -perm -4000 -type f 2&gt;/dev/null</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Find SUID files owned by root</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>find / -perm -2000 -type f 2&gt;/dev/null</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Find GUID files</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>find / -perm -2 -type f 2&gt;/dev/null</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Find world-writeable files</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>find / ! -path "*/proc/*" -perm -2 -type f -print 2&gt;/dev/null</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Find world-writeable files excluding those in /proc</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>find / -perm -2 -type d 2&gt;/dev/null</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Find word-writeable directories </span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>find /home –name *.rhosts -print 2&gt;/dev/null</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Find rhost config files</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>find /home -iname *.plan -exec ls -la {} ; -exec cat {} 2&gt;/dev/null ;</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Find *.plan files, list permissions and cat the file contents</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>find /etc -iname hosts.equiv -exec ls -la {} 2&gt;/dev/null ; -exec cat {} 2&gt;/dev/null ;</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Find hosts.equiv, list permissions and cat the file contents</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>ls -ahlR /root/</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">See if you can access other user directories to find interesting files</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>cat ~/.bash_history</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Show the current users’ command history</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>ls -la ~/.*_history</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Show the current users’ various history files</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>ls -la /root/.*_history</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Can we read root’s history files</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>ls -la ~/.ssh/</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Check for interesting ssh files in the current users’ directory</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>find / -name "id_dsa*" -o -name "id_rsa*" -o -name "known_hosts" -o -name "authorized_hosts" -o -name "authorized_keys" 2&gt;/dev/null |xargs -r ls -la</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Find SSH keys/host information</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>ls -la /usr/sbin/in.*</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Check Configuration of inetd services</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>grep -l -i pass /var/log/*.log 2&gt;/dev/null</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Check log files for keywords (‘pass’ in this example) and show positive matches</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>find /var/log -type f -exec ls -la {} ; 2&gt;/dev/null</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">List files in specified directory (/var/log)</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>find /var/log -name *.log -type f -exec ls -la {} ; 2&gt;/dev/null</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">List .log files in specified directory (/var/log)</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>find /etc/ -maxdepth 1 -name *.conf -type f -exec ls -la {} ; 2&gt;/dev/null</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">List .conf files in /etc (recursive 1 level)</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>ls -la /etc/*.conf</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">As above</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="24"><span style="font-family: Arial, sans-serif;"><code>find / -maxdepth 4 -name *.conf -type f -exec grep -Hn password {} ; 2&gt;/dev/null</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Find .conf files (recursive 4 levels) and output line number where the word ‘password’ is located</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>lsof -i -n</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">List open files (output will depend on account privileges)</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>head /var/mail/root</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Can we read roots mail</span></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><span style="font-family: Arial, sans-serif;"><b>Service Information:</b></span></p>
<table border="1" width="100%" cellspacing="0" cellpadding="10">
<colgroup>
<col width="117">
<col width="139"> </colgroup>
<tbody>
<tr valign="TOP">
<td width="46%"><span style="font-family: Arial, sans-serif;"><b>Command</b></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;"><b>Result</b></span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>ps aux | grep root</code></span></td>
<td width="54%">View services running as root</td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>ps aux | awk '{print $11}'|xargs -r ls -la 2&gt;/dev/null |awk '!x[$0]++'</code></span></td>
<td width="54%">Lookup process binary path and permissions</td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>cat /etc/inetd.conf</code></span></td>
<td width="54%">List services managed by inetd</td>
</tr>
<tr valign="TOP">
<td width="46%"><span style="font-family: Arial, sans-serif;"><code>cat /etc/xinetd.conf</code></span></td>
<td width="54%">As above for xinetd</td>
</tr>
<tr valign="TOP">
<td width="46%"><span style="font-family: Arial, sans-serif;"><code>cat /etc/xinetd.conf 2&gt;/dev/null | awk '{print $7}' |xargs -r ls -la 2&gt;/dev/null</code></span></td>
<td width="54%">A very ‘rough’ command to extract associated binaries from xinetd.conf and show permissions of each</td>
</tr>
<tr valign="TOP">
<td width="46%"><span style="font-family: Arial, sans-serif;"><code>ls -la /etc/exports 2&gt;/dev/null; cat /etc/exports 2&gt;/dev/null</code></span></td>
<td width="54%">Permissions and contents of /etc/exports (NFS)</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><span style="font-family: Arial, sans-serif;"><b>Jobs/Tasks:</b></span></p>
<table border="1" width="100%" cellspacing="0" cellpadding="10">
<colgroup>
<col width="117">
<col width="139"> </colgroup>
<tbody>
<tr valign="TOP">
<td width="46%"><span style="font-family: Arial, sans-serif;"><b>Command</b></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;"><b>Result</b></span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>crontab -l -u %username%</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Display scheduled jobs for the specified user –&nbsp;<span style="color: #ff0000;">Privileged command</span></span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>ls -la /etc/cron*</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Scheduled jobs overview (hourly, daily, monthly etc)</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>ls -aRl /etc/cron* | awk '$1 ~ /w.$/' 2&gt;/dev/null</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">What can ‘others’ write in /etc/cron* directories</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>top</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">List of current tasks</span></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><span style="font-family: Arial, sans-serif;"><b>Networking, Routing &amp; Communications:</b></span></p>
<table border="1" width="100%" cellspacing="0" cellpadding="10">
<colgroup>
<col width="117">
<col width="139"> </colgroup>
<tbody>
<tr valign="TOP">
<td width="46%"><span style="font-family: Arial, sans-serif;"><b>Command</b></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;"><b>Result</b></span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>/sbin/ifconfig -a</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">List all network interfaces</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>cat /etc/network/interfaces</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">As above</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>arp -a</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Display ARP communications</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>route</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Display route information</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>cat /etc/resolv.conf</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Show configured DNS sever addresses</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>netstat -antp</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">List all TCP sockets and related PIDs (-p&nbsp;<span style="color: #ff0000;">Privileged command</span>)</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>netstat -anup</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">List all UDP sockets and related PIDs&nbsp;(-p&nbsp;<span style="color: #ff0000;">Privileged command</span>)</span></td>
</tr>
<tr valign="TOP">
<td width="46%"><span style="font-family: Arial, sans-serif;"><code>iptables -L</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">List rules&nbsp;–&nbsp;<span style="color: #ff0000;">Privileged command</span></span></td>
</tr>
<tr valign="TOP">
<td width="46%"><span style="font-family: Arial, sans-serif;"><code>cat /etc/services</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">View port numbers/services mappings</span></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><span style="font-family: Arial, sans-serif;"><b>Programs Installed:</b></span></p>
<table border="1" width="100%" cellspacing="0" cellpadding="10">
<colgroup>
<col width="117">
<col width="139"> </colgroup>
<tbody>
<tr valign="TOP">
<td width="46%"><span style="font-family: Arial, sans-serif;"><b>Command</b></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;"><b>Result</b></span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>dpkg -l</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Installed packages (Debian)</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>rpm -qa</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Installed packages (Red Hat)</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>sudo -V</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Sudo version – does an exploit exist?</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>httpd -v</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Apache version</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>apache2 -v</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">As above</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>apache2ctl (or apachectl) -M</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">List loaded Apache modules</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>mysql --version</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Installed MYSQL version details</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>psql -V</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Installed Postgres version details</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>perl -v</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Installed Perl version details</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>java -version</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Installed Java version details</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>python --version</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Installed Python version details</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>ruby -v</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Installed Ruby version details</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>find / -name %program_name% 2&gt;/dev/null</code>&nbsp;(i.e. nc, netcat, wget, nmap etc)</span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Locate ‘useful’ programs (netcat, wget etc)</span></td>
</tr>
<tr valign="TOP">
<td width="46%"><span style="font-family: Arial, sans-serif;"><code>which %program_name%</code> (i.e. nc, netcat, wget, nmap etc)</span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">As above</span></td>
</tr>
<tr valign="TOP">
<td width="46%"><span style="font-family: Arial, sans-serif;"><code>dpkg --list 2&gt;/dev/null| grep compiler |grep -v decompiler 2&gt;/dev/null &amp;&amp; yum list installed 'gcc*' 2&gt;/dev/null| grep gcc 2&gt;/dev/null</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">List available compilers</span></td>
</tr>
<tr valign="TOP">
<td width="46%"><span style="font-family: Arial, sans-serif;"><code>cat /etc/apache2/envvars 2&gt;/dev/null |grep -i 'user|group' |awk '{sub(/.*export /,"")}1'</code></span><span style="font-family: Arial, sans-serif;"></span><p></p>
</td><td width="54%"><span style="font-family: Arial, sans-serif;">Which account is Apache running as</span></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><span style="font-family: Arial, sans-serif;"><b>Common Shell Escape Sequences:</b></span></p>
<table border="1" width="100%" cellspacing="0" cellpadding="10">
<colgroup>
<col width="117">
<col width="139"> </colgroup>
<tbody>
<tr valign="TOP">
<td width="46%"><span style="font-family: Arial, sans-serif;"><b>Command</b></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;"><b>Program(s)</b></span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>:!bash</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">vi, vim</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>:set shell=/bin/bash</code></span><span style="font-family: Arial, sans-serif;"><code>:shell</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">vi, vim</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>!bash</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">man,&nbsp;</span><span style="font-family: Arial, sans-serif;">more,&nbsp;</span><span style="font-family: Arial, sans-serif;">less</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>find / -exec /usr/bin/awk 'BEGIN {system("/bin/bash")}' ; </code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">find</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>awk 'BEGIN {system("/bin/bash")}'</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">awk</span></td>
</tr>
<tr valign="TOP">
<td width="46%" height="1"><span style="font-family: Arial, sans-serif;"><code>--interactive</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">nmap</span></td>
</tr>
<tr valign="TOP">
<td width="46%"><span style="font-family: Arial, sans-serif;"><code>perl -e 'exec "/bin/bash";'</code></span></td>
<td width="54%"><span style="font-family: Arial, sans-serif;">Perl</span></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>A special thanks to the following useful resources:</p>
<ul>
<li><a href="http://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation.html" target="_blank"><span style="line-height: 13px;">g0tm1lk</span></a></li>
<li><a href="http://pen-testing.sans.org/resources/downloads" target="_blank">SANS&nbsp;Pentesting Resources</a></li>
</ul>
<p>&nbsp;</p>

<div class="twitter-share"><iframe id="twitter-widget-2" scrolling="no" frameborder="0" allowtransparency="true" class="twitter-share-button twitter-share-button-rendered twitter-tweet-button" title="Twitter Tweet Button" src="https://platform.twitter.com/widgets/tweet_button.39f7ee9fffbd122b7a37a520dbdaebc6.en-gb.html#dnt=false&amp;id=twitter-widget-2&amp;lang=en-gb&amp;original_referer=https%3A%2F%2Fwww.rebootuser.com%2F%3Fp%3D1623&amp;size=m&amp;text=%40Rebootuser%20%7C%20Local%20Linux%20Enumeration%20%26%20Privilege%20Escalation%20Cheatsheet&amp;time=1477356875751&amp;type=share&amp;url=https%3A%2F%2Fwww.rebootuser.com%2F%3Fp%3D1623&amp;via=rebootuser" style="position: static; visibility: visible; width: 61px; height: 20px;" data-url="https://www.rebootuser.com/?p=1623"></iframe></div>
<!-- AddThis Sharing Buttons below -->					</div>
